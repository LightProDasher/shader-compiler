From a4713982b9e596e8fdebe55c1601758815cd3850 Mon Sep 17 00:00:00 2001
From: Billy Laws <blaws05@gmail.com>
Date: Thu, 4 Aug 2022 20:21:19 +0100
Subject: [PATCH 2/2] Workaround image arg type error

---
 backend/spirv/emit_spirv_image.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/backend/spirv/emit_spirv_image.cpp b/backend/spirv/emit_spirv_image.cpp
index 009e18e..456254a 100644
--- a/backend/spirv/emit_spirv_image.cpp
+++ b/backend/spirv/emit_spirv_image.cpp
@@ -189,7 +189,7 @@ Id TextureImage(EmitContext& ctx, IR::TextureInstInfo info, const IR::Value& ind
 }
 
 Id Image(EmitContext& ctx, const IR::Value& index, IR::TextureInstInfo info) {
-    if (!index.IsImmediate() || index.U32() != 0) {
+    if (index.Type() == IR::Type::U32 && (!index.IsImmediate() || index.U32() != 0)) {
         throw NotImplementedException("Indirect image indexing");
     }
     if (info.type == TextureType::Buffer) {
-- 
2.37.0

